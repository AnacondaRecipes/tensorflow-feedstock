From 919b803ee8f6e0cb0c1fe75244281718624f2d1f Mon Sep 17 00:00:00 2001
From: "H. Vetinari" <h.vetinari@gmx.com>
Date: Mon, 13 May 2024 09:41:09 +1100
Subject: [PATCH 28/28] add absl_crc32c target

---
 third_party/absl/system.absl.crc.BUILD | 24 ++++++++++++++++++++++++
 third_party/absl/workspace.bzl         |  1 +
 2 files changed, 25 insertions(+)
 create mode 100644 third_party/absl/system.absl.crc.BUILD

diff --git a/third_party/absl/system.absl.crc.BUILD b/third_party/absl/system.absl.crc.BUILD
new file mode 100644
index 00000000000..60c81a4e518
--- /dev/null
+++ b/third_party/absl/system.absl.crc.BUILD
@@ -0,0 +1,24 @@
+load("@rules_cc//cc:defs.bzl", "cc_library")
+
+package(default_visibility = ["//visibility:public"])
+
+cc_library(
+    name = "crc32c",
+    linkopts = [
+        "-labsl_crc32c",
+        "-labsl_crc_cord_state",
+        "-labsl_crc_cpu_detect",
+        "-labsl_crc_internal",
+    ],
+    deps = [
+        ":cpu_detect",
+        ":crc_internal",
+        ":non_temporal_memcpy",
+        "//absl/base:config",
+        "//absl/base:core_headers",
+        "//absl/base:endian",
+        "//absl/base:prefetch",
+        "//absl/strings",
+        "//absl/strings:str_format",
+    ],
+)
diff --git a/third_party/absl/workspace.bzl b/third_party/absl/workspace.bzl
index c54df3cfbae..94ee77bb7d2 100644
--- a/third_party/absl/workspace.bzl
+++ b/third_party/absl/workspace.bzl
@@ -14,6 +14,7 @@ def repo():
     SYS_DIRS = [
         "algorithm",
         "base",
+        "crc",
         "cleanup",
         "container",
         "debugging",
